<!DOCTYPE html>

<meta name=viewport content="width=device-width, initial-scale=1">

<html>
  <head>
    <title>CalVote</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
    <!-- cdn for modernizr, if you haven't included it already -->
	<script src="http://cdn.jsdelivr.net/webshim/1.12.4/extras/modernizr-custom.js"></script>
	<!-- polyfiller file to detect and load polyfills -->
	<script src="http://cdn.jsdelivr.net/webshim/1.12.4/polyfiller.js"></script>
	<script>
	  webshims.setOptions('waitReady', false);
	  webshims.setOptions('forms-ext', {types: 'date'});
	  webshims.polyfill('forms forms-ext');
	</script>

  </head>

	<body>
		<div id="firstBox">
			<form id="centerBox" class="fade-in" action="javascript:void(0);">
				<h3>
				<span style="color: #ecbb59">Vote</span><span style="color: #0000B2">CA</span>
				</h3>
	  
				<input type="submit" value="Upcoming" onclick="upcoming()" />

		  <h3>- OR -</h3>



		    <label for="bill">Bill Number</label>
				<input type="text" id="bill" name="firstname" placeholder="Number...">


				<label for="day">Day</label><br>
        		<input type="date" id="day" name="day"><br>


				<!--<label for="county">County</label>
				<select id="county" name="county">
				<option value="SF">San Francisco</option>
				<option value="SM">San Mateo</option>
				<option value="SC">Santa Clara</option>
				</select>-->

				<input type="submit" value="Search" onclick="search()" />
			</form>
		</div>
		
		<div id="secondBox">
			<h3>
				<span style="color: #ecbb59">Vote</span><span style="color: #0000B2">CA</span>
			</h3>
			<div id="text">
			</div>
		</div>
		<input type="submit" id="back" value="Back" onclick="backToMain()" disabled/>
		
	</body>
	
	<script>
	//1439185
		function fillBillInfo(x) {
			var key = "d09ad1beb3b885847a39492a0f66987d";
			var url = "https://api.legiscan.com/?key=" + key + "&op=";
			var xhr = new XMLHttpRequest();
			xhr.open("GET", url + "getBillText&id="+x, false);
			xhr.send();
			testyj = JSON.parse(xhr.responseText);
			document.getElementById("text").innerHTML = atob(testyj.text.doc);
		}
	
		var current =  document.getElementById("firstBox");
		function upcoming() {
			//console.log("Upcoming");
			transitionOut(current);
		}
	
		function search() {
			var billNum = document.getElementById("bill").value;
			var day;
			if (document.getElementById("day") != null) {
				day = document.getElementById("day").value;
			} else {
				day = null;
			}
			//console.log("Search for:", billNum, day);
			
			if (billNum != "" || day != "") {
				
				transitionOut(document.getElementById("firstBox"));
				if (billNum != "") {
					specificBill();
				}
			}	
		}
		
		function specificBill() {
			fillBillInfo("1439185");
			var boxTwo = document.getElementById("secondBox");
			current = boxTwo;
			setTimeout(function(){
				current.classList.remove("translateOut");
				current.classList.add("fade-in");
				document.getElementById("back").style.opacity = 1;
				document.getElementById("back").disabled = false;
			}, 500); 
		}
	
		function transitionOut(x) {
			x.classList.add("translateOut");
			x.style.opacity="0";
		}
		
		function backToMain() {
			transitionOut(current);
			var firstBox = document.getElementById("firstBox");
			current = firstBox;
			setTimeout(function(){
				current.classList.remove("translateOut");
				current.classList.add("fade-in");
			}, 500); 
			
			document.getElementById("back").style.opacity = 0;
			document.getElementById("back").disabled = true;
		}

	</script>
</html>
